# SUID, SGID, Sticky bit

- 실행 파일에만 적용된다. 파일이 실행된 프로세스는 실행한 사용자 소유로 실행 권한이 부여되지만 suid,  
sgid를 설정한 파일의 프로세스는 파일 소유자나 그룹 소유자의 ID로 실행된다. 실행 권한에 s로 명시됩니다.

---

## SUID(4)

- 실행 파일에 SUID가 설정되면 파일을
- 실행하는 사용자가 아니라 `파일 소유자 권한`으로 실행된다.

### 설정 방법

```text
chmod 4755 [파일명] or chmod u+s [파일명]
```

### 표시 방법

```text
-rwSr-xr-x
```
- 실행 권한 위치에 s 표시

---

## SGID(2)

- 파일에 SGID 설정 시
- 실행할 때 파일의 그룹 권한으로 실행된다.
- 디렉토리에 SGID 설정 시 그 디렉토리 안에서 생성되는 파일은 `부모 디렉토리의 그룹을 상속`한다.

### 설정 방법

```text
chmod 2755 [파일명] or chmod g+s [파일명]
```

---

### 표시 방법

```text
-rwxr-Sr-x
```
-  그룹 실행 위치에 s 표시

---

## Sticky Bit(1)

- 디렉토리에 설정되며 파일 삭제 권한을 제한한다.
- 공용 디렉토리에서 본인이 생성한 파일만 삭제 가능하게 만든다.

### 설정 방법

```text
chmod 1777 [디렉토리명] 또는 chmod o+t [디렉토리명]
```

### 표시 방법

```text
drwxrwxrwt
```
- 기타 실행 위치에 t 표시

---

## 핵심 차이 정리

| 구분 | 적용 대상 | 동작 |
|------|------------|------|
| SUID | 실행 파일 | 파일 소유자 권한으로 실행 |
| SGID | 파일 | 파일 그룹 권한으로 실행 |
| SGID | 디렉토리 | 생성 파일에 그룹 상속 |
| Sticky | 디렉토리 | 파일 삭제 제한 |

---

## 주요 파일 속성 정리

| 속성 | 이름(의미) | 설명 |
|:---:|:---|:---|
| `a` | Append only | 추가 모드로만 오픈 가능<br>기존 내용 수정·삭제 불가, root만 속성 변경 가능 |
| `i` | Immutable | 변경·삭제·이름 변경·링크 생성 모두 금지 |
| `A` | No atime update | 파일 접근 시 atime(접근 시간) 갱신 금지 |
| `d` | No dump | dump 명령을 이용한 백업 대상에서 제외 |
| `S` | Synchronous update | 파일 수정 시 디스크에 즉시 동기화 |
| `D` | Synchronous directory update | 디렉토리 변경 사항을 실시간으로 디스크에 동기화 |

---

## Lastter

- 파일 속성 확인

- **형식 :**
```text
lsattr [옵션] 대상
```

- **옵션 :**
```text
-d : 디렉토리 자체만 출력
-R : 하위 전체 출력
-a : 숨김파일 포함
```

---

## Chattr

- 파일 속성 변경

- **형식 :**
```text
chattr [연산자][속성] 대상
```

- **연산자 :**
```text
+ : 추가
- : 삭제
= : 해당 속성만 설정
```

- **옵션 :**
```text
-R : 하위 전체 적용
```

- **예시 :**
```text
chattr +aAS a.txt
chattr =i a.txt
```
- i 속성 설정 시 : 삭제 불가합니다.
  - rm -rf a.txt (삭제를 하지 못합니다.)
