# DDL (Data Definition Language)

## DDL 명령어

| 명령어 | 설명 |
|------|------|
| CREATE | 테이블, 뷰, 시퀀스 등 객체 생성 |
| ALTER | 기존 객체 구조 변경 |
| DROP | 객체 전체 삭제 (구조까지 완전 제거) |
| RENAME | 객체 이름 변경 |
| TRUNCATE | 테이블 데이터 전체 삭제 (ROLLBACK 불가, 물리공간 반환) |

---

## 테이블 생성 규칙

- 문자로 시작
- 30자 이내
- 영문, 숫자, _, $, # 사용 가능
- 같은 유저(스키마) 내에서 유일
- 예약어 사용 불가
- 대소문자 구별 안 함 (딕셔너리에 대문자로 저장)

```sql
  CREATE TABLE board (
  no NUMBER,
  name VARCHAR2(50),
  sub VARCHAR2(100),
  content VARCHAR2(4000),
  hdate DATE DEFAULT SYSDATE
  );
```

### 데이터 타입

| 데이터 타입 | 설명 (간단 요약) |
|-------------|------------------|
| VARCHAR2(n) | 가변 길이 문자 타입 (1 < n < 4000 byte). 입력한 길이만큼만 저장 |
| CHAR(n) | 고정 길이 문자 타입 (1 < n < 2000 byte). 항상 n만큼 공간 차지 (공백 채움) |
| NUMBER(n,p) | 숫자 타입. n=전체 자리수, p=소수점 이하 자리수. 전체 자리수 초과 시 에러, 소수점 초과 시 반올림 |
| DATE | 날짜 타입. 내부적으로 YYYY/MM/DD HH24:MI:SS 형태로 저장 |
| LONG | 최대 2GB 가변 문자 타입. 조건 검색 불가, 테이블당 1개만 가능 |
| CLOB | LONG 개선형. 최대 4GB 문자 저장, 여러 컬럼에 사용 가능 |
| BLOB | 최대 4GB 이진(Binary) 데이터 저장 (이미지, 파일 등) |
| ROW(n) | 가변 길이 이진 타입 |
| BFILE | 4GB 이내 외부 파일을 참조하는 이진 타입 |
| ROWID | 행의 물리적 주소 저장 타입 (64진수 인코딩) |

---

## 문자형 데이터 처리 기준

- **문자와 숫자**
  - 주민번호, 학번, 군번 : 문자
  - 숫자로 보이지만 연산 불필요 시 `VARCHAR2` 사용합니다.

- **금액, 수량 등 계산 대상**
  - 연산 가능성 존재하므로 `NUMBER` 사용합니다.

- **VARCHAR와 VARCHAR2**
  - 같은 데이터 타입

- **CHAR & VARCHAR2**
  - CHAR의 장점은 없다.
  - 보통 VARCHAR2를 씁니다.

---

## CHAR vs VARCHAR2 비교

| 비교 | CHAR | VARCHAR2 |
|------|------|-----------|
| 길이 | 고정 | 가변 |
| 저장 방식 | 공백 패딩 발생 | 입력 길이만 저장 |
| 저장 효율 | 낮음 | 높음 |
| 실무 권장 | 비권장 | 권장 |

### 실습
```sql
  CREATE TABLE comp( 
  co1 CHAR(4),
  co2 VARCHAR2(4)
  );

  INSERT INTO comp VALUES ('AA','AA'); 
  SELECT LENGTHB(co1), LENGTHB(co2) FROM comp;
  SELECT * FROM comp WHERE co1='AA';
  SELECT * FROM comp WHERE co2='AA';
  SELECT * FROM comp WHERE co1=co2;
```

---

## 날짜 타입 컬럼 검색

```sql
  CREATE TABLE hd (
  no NUMBER,
  hdate DATE
  );

  INSERT INTO hd VALUES (1, sysdate);
```

```sql
  SELECT * FROM hd
```

- **나쁜 예**
```sql
  WHERE hdate LIKE '2021/10/02%';
```

- **권장 방식**
```sql
  WHERE hdate BETWEEN '2021/10/02' AND '2021/10/03';
  또는
  TO_CHAR(hdate,'YYYY/MM/DD:HH24:MI:SS');
```

---

## 테이블 삭제

- 테이블 구조까지 완전히 삭제됩니다.
- Oracle은 기본적으로 RECYCLEBIN에 보관하여 복구가 가능합니다.

```sql
  DROP TABLE board;
  DROP TABLE comp;
  DROP TABLE hd;
  
  PURGE RECYCLEBIN;
```

---

## 삭제 테이블 복구

```sql
  SELECT object_name, original_name FROM recyclebin;
  FLASHBACK TABLE ORIGINAL_NAME TO BEFORE DROP
  [RENAME TO NEW_NAME];
```

- TEST 테이블 삭제 후 복구 예시
```sql
  DROP TABLE test;

  SELECT * FROM tab;
  SELECT object_name, original_name FROM recyclebin;
  FLASHBACK TABLE test TO BEFORE DROP;

  SELECT * FROM tab;
```
