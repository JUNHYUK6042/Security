# Single Row Function (문자, 숫자, 날짜)

## 개요

- 단일 행 함수는 한 행(row)을 입력하면 한 행을 그대로 반환하는 함수입니다.
- SELECT, WHERE, HAVING 등 대부분의 절에서 사용 가능합니다.
- 인수로 컬럼, 상수, 표현식, 다른 함수의 결과를 사용할 수 있습니다.
- 종류는 숫자 함수, 날짜 함수, 문자 함수, 문자 치환 함수로 구분됩니다.

---

## 문자 함수

- 문자열을 변환하거나 일부를 추출하고 길이를 확인할 때 사용합니다.

| 함수명 | 형식 | 설명 | 예시 |
|--------|------|------|------|
| LOWER | LOWER(str) | 소문자 변환 | LOWER('ORACLE') → oracle |
| UPPER | UPPER(str) | 대문자 변환 | UPPER('oracle') → ORACLE |
| INITCAP | INITCAP(str) | 첫 글자만 대문자 | INITCAP('oracle') → Oracle |
| SUBSTR | SUBSTR(str, pos, len) | 문자열 일부 추출 | SUBSTR('oracle',1,2) → or |
| INSTR | INSTR(str, substring) | 특정 문자 위치 | INSTR('ORACLE','A') → 3 |
| TRIM | TRIM(char FROM str) | 앞뒤 문자 제거 | TRIM('o' FROM 'oracle') → racle |
| LENGTH | LENGTH(str) | 글자 수 | LENGTH('디비') → 2 |
| LENGTHB | LENGTHB(str) | 바이트 수 | LENGTHB('디비') → 6 |
| LPAD/RPAD | LPAD(str, n, fill) | 좌우 문자 채우기 | LPAD('20000',10,'*') → *****20000 |

### 문자 함수를 이용한 검색 예제

- `부서명의 마지막 글자를 제외하고 검색하는 예시`
```sql
  SELECT dname, SUBSTR(dname, 1, LENGTH(dname)-1) dname
  FROM dept; 
```

- `이름이 네 글자인 사원의 이름을 검색하는 예시`
```sql
  SELECT eno, ename
  FROM emp
  WHERE LENGTH(ename) = 4;
```

---

## 문자 함수 : 치환 함수

| 함수명 | 형식 | 설명 | 예시 |
|--------|--------|--------|------|
| TRANSLATE | TRANSLATE(str, 검색문자, 치환문자) | 문자 단위로 각각 치환된 값을 반환 | TRANSLATE('oracle','a','#') → or#cle |
| REPLACE | REPLACE(str, 검색문자열, 치환문자열) | 문자열 단위로 치환된 값을 반환 | REPLACE('oracle','or','##') → ##acle |

### 치환 함수를 이용한 검색 예제

- `원문의 'Wo'를 TRANSLATE, REPLACE 함수를 통해 '--'로 변환 하는 예시`

```sql
  SELECT TRANSLATE('World of Warcraft', 'Wo', '--') Translate,
  REPLACE('World of Warcraft', 'Wo', '--') Replace 
  FROM dual;
```

---

## 숫자 함수

- 숫자를 반올림하거나 절삭하고, 나머지 및 거듭제곱을 계산할 때 사용합니다.

| 함수명 | 형식 | 설명 | 예시 |
|-------|------|------|------|
| ROUND | ROUND(m, n) | 반올리하여 소수 이하 n자리까지 출력 | ROUND(123.4567, 3) → 123.457 |
| TRUNC | TRUNC(m, n) | 소수 이하 n자리 미만 절삭 | TRUNC(123.4567, 3) → 123.456 |
| MOD | MOD(m, n) | m을 n으로 나눈 나머지를 계산 | MOD(10, 4) → 2 |
| POWER | POWER(m, n) | m의 n제곱 | POWER(2, 4) → 16 |
| CEIL | CEIL(m) | m보다 큰 가장 작은 정수 | CEIL(2.34) → 3 |
| FLOOR | FLOOR(m) | m보다 작은 가장 큰 정수 | FLOOR(2.34) → 2 |
| SQRT | SQRT(m) | 제곱근 | SQRT(9) → 3 |
| SIGN | SIGN(m) | 부호 반환 | SIGN(-3) → -1 |

- `다양한 숫자 함수의 이용한 검색 예시`
```sql
  SELECT ROUND(98.765), TRUNC(98.765),
  ROUND(98.765,2), TRUNC(98.765,2)
  FROM dual;

  SELECT MOD(19,3), MOD(-19,3)
  FROM dual;

  SELECT CEIL(3.5), FLOOR(3.5)
  FROM dual;

  SELECT POWER(13,4), SQRT(16)
  FROM dual;
```

---

## 날짜 연산 및 날짜 함수

### 날짜 연산

| 연산 | 결과 | 의미 |
|------|------|------|
| 날짜 + m | 날짜 | m일 후 |
| 날짜 - m | 날짜 | m일 전 |
| 날짜 - 날짜 | 숫자 | 두 날짜 간 일수 |

- `오늘 날짜, 입사 일자, 입사일로부터 오늘까지 기간, 입사일 후 100일 되는 날 검색 예시`
```sql
  SELECT eno, ename, sysdate 오늘, hdate 입사일, TRUNC(sysdate)-TRUNC(hdate)+1 근무일, hdate+99 "100일"
  FROM emp;
```
---

## 날짜 함수

| 함수명 | 형식 | 설명 | 예시 |
|--------|------|------|------|
| ROUND | ROUND(날짜, 형식) | 지정한 형식 기준으로 날짜 반올림 | ROUND(sysdate, 'DD') → 2021/09/23 |
| TRUNC | TRUNC(날짜, 형식) | 지정한 형식 기준으로 날짜 절삭 | TRUNC(sysdate, 'YYYY') → 2021/01/01 |
| MONTHS_BETWEEN | MONTHS_BETWEEN(날짜1, 날짜2) | 두 날짜 간 개월 수 계산 | MONTHS_BETWEEN('2013/09/01','2013/01/01') → 8 |
| LAST_DAY | LAST_DAY(날짜) | 해당 월의 마지막 날짜 반환 | LAST_DAY('2013/09/24') → 2013/09/30 |
| ADD_MONTHS | ADD_MONTHS(날짜, n) | 날짜에 n개월 추가 | ADD_MONTHS('2011/07/01', 23) → 2013/06/01 |
| NEXT_DAY | NEXT_DAY(날짜, 요일) | 지정 요일의 다음 날짜 반환 | NEXT_DAY('2013/07/14','일요일') → 2013/07/21 |

### 날짜 함수 이용

```sql
   ALTER SESSION SET nls_date_format = 'YYYY/MM/DD:HH24:MI:SS';
```

---

## ROUND(날짜, 형식)

- ROUND 함수는 날짜를 지정한 기준으로 반올림합니다.
- 기준 시점에 따라 날짜가 다음 단위로 넘어갈 수 있습니다.

| 형식 | 반올림 기준 |
|------|-------------|
| YYYY | 7월 1일 기준 |
| MM   | 매달 16일 기준 |
| DD   | 정오(12시) 기준 |

```sql
  SELECT sysdate, ROUND(sysdate,'YYYY') 년, ROUND(sysdate,'MM') 월, ROUND(sysdate,'DD') 일
  FROM dual;
```

---

## TRUNC(날짜, 형식)

- TRUNC 함수는 날짜를 절삭하여 기준 단위의 시작 시점으로 만듭니다.
- 시간 정보를 제거할 때 가장 많이 사용됩니다.

| 형식 | 절삭 결과 |
|------|-----------|
| YY   | 해당 연도의 1월 1일 |
| MM   | 해당 월의 1일 |
| DD   | 해당 날짜 00:00:00 |

- `문시현이 오늘까지 일한 일수를 검색 예시`
```sql
  SELECT ename, TRUNC(sysdate)-TRUNC(hdate)+1 DAY
  FROM emp
  WHERE ename='문시현';
```

---

## MONTHS_BETWEEN(날짜 1, 날짜2)

- 두 날짜 사이의 개월 수 차이를 실수 형태로 반환합니다.
- 기준 날짜의 크기에 따라 양수 또는 음수가 반환됩니다.

### 형식 및 예시

```sql 
  TRUNC(MONTHS_BETWEEN(d1, d2)) : 주로 많이 사용하는 형식입니다.
```

- `20번 부서 직원들이 현재까지 근무한 개월 수를 검색 예시`
```sql
  SELECT eno, ename, TRUNC(MONTHS_BETWEEN(sysdate,hdate)) 근무_개월
  FROM emp
  WHERE dno = '20';
```

---

## LAST_DAY(날짜)

- 지정한 날짜가 속한 달의 마지막 날짜를 반환합니다.

### 형식 및 예시

```sql
  SELECT LAST_DAY('2013/09/24') FROM dual; → 2013/09/30
```

- `20번 부서원들의 입사한 달의 마지막 날짜와 입사한 달에 근무 일수를 검색 예시`
```sql
  SELECT eno, ename, hdate, LAST_DAY(hdate) 마지막날, LAST_DAY(TRUNC(hdate))-TRUNC(hdate)+1 "입사한 달 근무일수"
  FROM emp
  WHERE dno = '20';
```

---

## ADD_MONTHS(날짜, n)

- 지정한 날짜에 n개월을 더한 날짜를 반환합니다.
- 날짜에 숫자를 더하면 일 단위 증가가 됩니다.

### 형식 및 예시
```sql
  SELECT ADD_MONTHS('2011/07/01', 23) FROM dual; → 2013/06/01
```

- `20번 부서원들이 입사한 이후 첫 번째 일요일을 검색 예시`
```sql
  SELECT eno, ename, hdate 입사일, hdate+99 "100일", ADD_MONTHS(hdate,120) "10년"
  FROM emp
  WHERE dno = '20';
```

---

## NEXT_DAY(날짜, 요일)

- 기준 날짜 이후 처음 도래하는 지정 요일의 날짜를 반환합니다.
- 세션 언어 설정에 따라 요일 문자열이 달라집니다.

```sql
SELECT NEXT_DAY('2013/07/14', '일요일') FROM dual; → 2013/07/21
```

- `20번 부서원들이 입사한 이후 첫 번째 일요일을 검색 예시`
```sql
  SELECT eno, ename, hdate, NEXT_DAY(hdate,'일요일') Sunday
  FROM emp
  WHERE dno = '20';
```

---

## Single-Row Conversion Function (TO_CHAR, TO_DATE, TO_NUMBER)

| 함수명 | 형식 | 설명 | 예시 |
|--------|------|------|------|
| TO_CHAR | TO_CHAR(날짜, 형식)<br>TO_CHAR(숫자, 형식) | 날짜나 숫자를 지정된 형식의 문자로 변환 | TO_CHAR(sysdate,'YYYY/MM/DD') |
| TO_DATE | TO_DATE(문자, 형식) | 문자를 지정된 형식의 날짜로 해석 | TO_DATE('19920101','YYYYMMDD') |
| TO_NUMBER | TO_NUMBER(문자) | 문자를 숫자로 해석 | TO_NUMBER('12345') |

---

## 날짜 시간 형식

| 형식 | 의미 | 예 |
|------|------|------|
| YYYY | 네 자리 연도 | 2021 |
| YY | 두 자리 연도 (99-2099) | 99 |
| RR | 두 자리 연도 (99-1999) | 99 |
| MM | 숫자 월 | 01, 02 |
| MONTH | 문자 월 | MARCH |
| MON | 월 약자 | MAR |
| DD | 일 | 01 |
| DAY | 요일 | SUNDAY |
| DY | 요일 약자 | MON |
| HH24 | 24시간 형식 | 01~24 |
| HH | 12시간 형식 | 01~12 |
| MI | 분 | 00~59 |
| SS | 초 | 00~59 |
| SSSSSS | 하루를 초로 환산 | 0~86399 |
| AM/PM | 오전/오후 표시 | AM |

---

## 숫자 형식

| 형식 | 의미 |
|------|------|
| 9 | 숫자 출력 폭 지정 |
| 0 | 선행 0 표시 |
| $ | 달러 화폐 기호 |
| L | 국가별 화폐 기호 |
| , | 세 자리마다 쉼표 |
| . | 소수점 위치 지정 |
| MI | 음수 부호를 오른쪽에 표시 |
| EEEE | 지수 표현 방식 |

---

## TO_CHAR 날짜 검색

- `오늘 날짜 검색 예시`
```sql
  SELECT TO_CHAR(sysdate, 'YYYY/MM/DD') 날짜, TO_CHAR(sysdate, 'YYYY/MM/DD:HH24:MI:SS') 날짜, TO_CHAR(sysdate, 'YY/MM/DD:HH:MI:SS AM') 날짜
  FROM dual;
```

- `요일까지 검색 예시`
```sql
  SELECT TO_CHAR(sysdate, 'DAY Mon YY') 날짜
  FROM DUAL;
```

- `문장 출력 예시`
```sql
  SELECT ename||' 사원의 입사일은 '||TO_CHAR(hdate, 'YYYY"년 "MM"월 "DD"일 입니다."') 입사일
  FROM emp;
```

---

## TO_CHAR 숫자 검색

```sql
  SELECT TO_CHAR(12345.678, '999,999.99999') num FROM dual;
```
- 999,999 → 정수부 6자리 확보
- .99999 → 소수 5자리 확보
- 부족한 소수 자리는 0으로 채워진다.

```sql
  SELECT TO_CHAR(12345.678, '099,999.999') FROM dual;
```
- 앞의 0은 빈 자리를 0으로 채움
- 9는 빈 자리면 공백 처리
- 소수 3자리까지만 출력

```sql
SELECT TO_CHAR(12345.678, '9,999.9') FROM dual;
```
- 정수부 자릿수가 부족
- 표현 범위를 초과하면 #으로 출력됨

```slq
SELECT TO_CHAR(1234, '$999,999') FROM dual;
```
- $ 기호 출력
- 숫자는 오른쪽 정렬
- 남는 자리는 공백 처리

```sql
SELECT TO_CHAR(1234, 'L999,999') FROM dual;
```
- L은 지역 화폐 기호
- 시스템 NLS 설정에 따라 달라짐

```sql
SELECT TO_CHAR(123456789, '9.999EEEE') FROM dual;
```
- 지수 표기 방식
- 소수 3자리까지 반올림
- 123,456,789 → 1.235 × 10^8

```sql
SELECT TO_CHAR(-1234, '999,999MI') FROM dual;
```
- MI는 음수 부호를 오른쪽에 표시
- 음수일 때 뒤에 '-' 표시

---

## TO_DATE 검색

- 문자열 날짜는 반드시 TO_DATE로 변환해야 비교 가능
```sql
  SELECT eno 사번, ename 이름, hdate 입사일
  FROM emp
  WHERE hdate < TO_DATE('19920101','YYYYMMDD');

  SELECT eno 사번, ename 이름, hdate 입사일
  FROM emp
  WHERE hdate <= TO_DATE('19911231:235959','YYYYMMDD:HH24MISS');
```

---

## TO_NUMBER
```sql
SELECT TO_NUMBER('1,234', '9,999') + 100 AS result
FROM dual;
```

---
